<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.2//EN"
"http://www.oasis-open.org/docbook/xml/4.2/docbookx.dtd">
<chapter id="moduleundbloecke" lang="de_DE" status="draft">
  <!-- $Id$ -->

  <chapterinfo>
    <releaseinfo>$Revision$</releaseinfo>

    <date>$Date$</date>
  </chapterinfo>

  <title>Module und Blöcke<indexterm>
      <primary>Module</primary>
    </indexterm><indexterm>
      <primary>Blöcke</primary>
    </indexterm></title>

  <para>PostNuke kann in seinem Funktionsumfang durch sogennante Module
  erweitert werden. In der Standardauslieferung von PostNuke sind bereits
  einige Module integriert. Der Administrator kann entscheiden, welche er auf
  seiner Seite einsetzen, deaktiveren oder auch ggfs. löschen möchte.
  Weiterhin gibt es zahlreiche Downloadquellen für zusätzliche Module (z.B.
  <ulink
  url="http://mods.postnuke.com/index.php">http://mods.postnuke.com</ulink>
  oder unsere <ulink
  url="http://www.post-nuke.net/Web_Links+index-req-viewlink-cid-2.html">Modulsammlung</ulink>).</para>

  <para>PostNuke zeigt die Inhalte des Moduls in der Mitte der Seite an. An
  den Rändern links, rechts und oben können sich mehrere Boxen befinden, z.B.
  ein Menü, die Anmeldefelder, eine Wetterinformation usw. Diese Boxen werden
  als 'Blöcke' bezeichnet. Nahezu jedes Modul bringt seine eigenen Blöcke
  mit.</para>

  <screenshot>
    <mediaobject>
      <imageobject>
        <imagedata align="center" fileref="modulebloecke.gif" format="GIF" />
      </imageobject>

      <caption>
        <para>Blöcke (blau unterlegt) und das aktuelle Modul (rot
        unterlegt)</para>
      </caption>
    </mediaobject>
  </screenshot>

  <section id="moduladministration">
    <title>Moduladministration<indexterm>
        <primary>Module</primary>

        <secondary>Administration</secondary>
      </indexterm><indexterm>
        <primary>Module</primary>

        <secondary>Verwaltung</secondary>
      </indexterm></title>

    <para>Da für die optimale Konfiguration von PostNuke ein Grundverständnis
    über die Funktions- und Arbeitsweise der Module von grosser Bedeutung ist,
    sollen hier kurz die Bedeutungen der Modulfunktionen initialisieren,
    aktivieren, editieren, deaktivieren, upgraden und entfernen (löschen!)
    erklärt werden. Diese Funktionen gelten für alle Module innerhalb von
    PostNuke.</para>

    <screenshot>
      <mediaobject>
        <imageobject>
          <imagedata align="center" fileref="moduladmin.gif" format="GIF" />
        </imageobject>

        <caption>
          <para>Die Moduladministration</para>
        </caption>
      </mediaobject>
    </screenshot>

    <bridgehead>Modulinstallation<indexterm>
        <primary>Module</primary>

        <secondary>Installation</secondary>
      </indexterm></bridgehead>

    <para>Module bestehen normalerweise aus mehreren Dateien (Funktionen,
    Grafiken, Sprachdateien usw.), die zusammen in einem Verzeichnis liegen,
    das den Namen des Moduls trägt. Dieses Verzeichnis muss ins Verzeichnis
    <filename>/modules</filename> auf dem Webserver kopiert werden. </para>

    <para>Die Installation / Konfiguration der Module erfolgt im
    Administrationsbereich über den Menüpunkt 'Module':</para>

    <variablelist>
      <varlistentry>
        <term>Alle anzeigen</term>

        <listitem>
          <para>zeigt eine Liste aller auf der Seite vorhanden Module mitsamt
          ihren jeweiligen Einstellungen an. Über die Buchstaben erreicht man
          die Module mit dem betreffenden Anfangsbuchstaben recht schnell.
          Darüber hinaus kann man in dem Dropdown-Feld auswählen, ob man alle
          Module, oder nur solche mit einem bestimmten Status sehen möchte.
          </para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Neu erzeugen</term>

        <listitem>
          <para>baut die Modulliste auf Grundlage der Verzeichnisinformationen
          in /modules neu auf. Jedesmal wenn ein neues Modul installiert (d.h.
          in das Modulverzeichnis /modules kopiert wird) muss die Modulliste
          neu erzeugt werden um die Änderungen des Dateisystems zu erkennen.
          Man kann die Liste aber auch generell vor dem anzeigen der
          Moduleinstellungen neu erzeugen um sicherzustellen, dass man mit den
          aktuellsten Informationen arbeitet.</para>
        </listitem>
      </varlistentry>
    </variablelist>

    <para>Ein Modul kann unterschiedliche Stati haben:</para>

    <variablelist>
      <varlistentry>
        <term>Nicht Initialisiert</term>

        <listitem>
          <para>Dies ist der erste Zustand eines Moduls nach dem Hochladen.
          Das Modul ist zwar im Dateisystem vorhanden, es befinden sich aber
          keine Informationen in der PostNuke-Datenbank. </para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Inaktiv</term>

        <listitem>
          <para>Nach dem Initialisieren, bei dem die Datenbankinformationen
          erzeugt werden, ist ein Modul zunächst inaktiv. </para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Aktiv</term>

        <listitem>
          <para>Diese Module sind bereit zum Einsatz</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Dateien fehlen</term>

        <listitem>
          <para>Ein initialisiertes Modul, dessen Dateien im Dateisystem
          fehlen. </para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Neue Version installiert</term>

        <listitem>
          <para>Zu diesem Modul ist eine neue Version installiert worden, die
          nun initialisiert werden muss. </para>
        </listitem>
      </varlistentry>
    </variablelist>

    <para>Die Konfiguration im Detail:</para>

    <variablelist>
      <varlistentry>
        <term>Initialisieren</term>

        <listitem>
          <para>Beim Initialisieren werden die für das Modul erforderlichen
          Datenbanktabellen und Variablen im System erzeugt. Module müssen
          stets initialisiert werden, bevor man mit ihnen arbeiten
          kann.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Aktivieren</term>

        <listitem>
          <para>Nach der Initialisierung kann ein Modul aktiviert werden,
          damit PostNuke darauf zugreifen kann.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Deaktivieren</term>

        <listitem>
          <para>Hiermit wird ein Modul deaktiviert, d.h. es ist für Benutzer
          nicht mehr nutzbar, obwohl alle Einstellungen noch im System
          vorhanden sind. Das Deaktivieren löscht weder Moduldateien, noch
          entsprechende Tabellen bzw. Variablen.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Entfernen</term>

        <listitem>
          <para>Entfernt ein deaktiviertes Modul vollständig, d.h. die
          entsprechenden Datenbanktabellen und Modulvariablen werden gelöscht.
          Das entsprechende Modulverzeichnis in <filename
          class="directory">/modules</filename> bleibt allerdings bestehen.
          </para>

          <caution>
            <para>Es gibt keine Sicherheitsabfrage beim Entfernen!</para>
          </caution>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Upgraden</term>

        <listitem>
          <para>Diese Funktion integriert neue Tabellen bzw. Variablen,
          nachdem eine neue Modulversion eingespielt wurde. Nach dem Upgraden
          muss das Modul erneut aktiviert werden.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Hooks</term>

        <listitem>
          <para>Hiermit können die im System vorhandenen "Hooks"
          modulspezifisch aktiviert werden. Mehr dazu in <xref
          linkend="hooksaktivieren" /></para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Editieren</term>

        <listitem>
          <para>Hier können folgende Einstellungen vorgenommen werden:</para>

          <variablelist>
            <varlistentry>
              <term>Neuer Name</term>

              <listitem>
                <para>Der Name, unter dem das Modul benutzt wird. Modulen kann
                damit ein zweiter Name gegeben werden, der passender ist (z.B.
                "Mitglieder" statt "Member_List"). Innerhalb des Systems
                werden dann alle Links entsprechend abgebildet, also in diesem
                Falle
                <systemitem>http://www.example.com/index.php?module=Mitglieder</systemitem>
                statt
                <systemitem>http://www.example.com/index.php?module=Member_List</systemitem>.
                Diese Abbildung funktioniert aber nur für API-konforme Module,
                der Zugriff hingegen ist auf jeden Fall über den Alias-Namen
                möglich.</para>
              </listitem>
            </varlistentry>

            <varlistentry>
              <term>Neue Beschreibung</term>

              <listitem>
                <para>Die Beschreibung wird für den Menüblock benutzt. Sie
                wird angezeigt, wenn der Mauszeiger über dem Link
                verweilt.</para>
              </listitem>
            </varlistentry>
          </variablelist>

          <screenshot>
            <mediaobject>
              <imageobject>
                <imagedata align="center" fileref="modul_alias.gif"
                           format="GIF" />
              </imageobject>

              <caption>
                <para>Ein Alias-Name für die Mitgliederliste</para>
              </caption>
            </mediaobject>
          </screenshot>
        </listitem>
      </varlistentry>
    </variablelist>

    <bridgehead>Modul Upgrade<indexterm>
        <primary>Module</primary>

        <secondary>Upgrade</secondary>
      </indexterm></bridgehead>

    <para>Beim Upgrade von Module sollten einige Schritte beachtet
    werden:</para>

    <procedure>
      <step>
        <para>Um die aktualisierte Version eines Moduls einzuspielen sollte
        man, wie es eigentlich bei jeder Aktion am System geraten wird, ein
        Datenbank-Dump und ein Datei-Backup erstellen.</para>
      </step>

      <step>
        <para>Dokumentation des Moduls lesen: Eventuell verlangt es nach
        geändertem Vorgehen.</para>
      </step>

      <step>
        <para>Nun löscht man das alte Modulverzeichnis (Achtung! Falls das
        Modul Dinge im Verzeichnis speichert - dieses Dateien natürlich nicht
        löschen)</para>
      </step>

      <step>
        <para>Jetzt kopiert man die neue Version des Moduls ins Verzeichnis
        und</para>
      </step>

      <step>
        <para>meldet sich mit Adminrechten auf der Site an, geht in die
        Administration</para>
      </step>

      <step>
        <para>unter 'Module' und erzeugt die Modulliste neu, und sucht dann
        das Modul raus.</para>
      </step>

      <step>
        <para>Hat die Aktion bis hier hin geklappt, steht da jetzt 'Upgrade'
        hinter. Jetzt diesen Link anklicken</para>
      </step>

      <step>
        <para>und danach noch mal
        <guimenuitem>aktivieren</guimenuitem>.</para>
      </step>

      <step>
        <para>Zum Schluß ausprobieren, ob das Modul auch so funktioniert, wie
        es sollte und sonst spielt man zur Not das Backup wieder ein.</para>
      </step>
    </procedure>

    <para>Damit die Upgrade-Funktionalität auch wirklich verlässlich
    funktioniert sollte auf jeden Fall mindestens die Version .726 installiert
    sein. Mit älteren Versionen kann es unter Umständen Probleme geben.</para>

    <bridgehead>Was macht man, wenn die PostNuke Installation durch die
    Installation eines neuen Blocks/Modules so gestört wird, dass man nicht
    mehr in das Block- oder Module-Administratormenü gelangt?</bridgehead>

    <para>Erstmal kann man die Adminsitration über <systemitem
    class="systemname">http://www.example.com/admin.php</systemitem>
    erreichen. Sollte auch das nicht mehr gehen, kann evtl. das Swiss Army
    Knife Tool helfen. Das ist vor allem bei fehlerhaften Themes der Fall. Als
    dritte Möglichkeit kann man natürlich auch manuell die Datenbank
    bearbeiten: Alle Tabellesn des Moduls löschen, alle dazugehörigen
    Variablen in der Tabelle
    <varname><replaceable>prefix</replaceable>_module_vars</varname> entfernen
    und in anschleißend der Tabelle
    <varname><replaceable>prefix</replaceable>_modules</varname> das Modul
    löschen.</para>

    <section id="hooksaktivieren">
      <title>Hooks für ein Modul aktivieren<indexterm>
          <primary>Module</primary>

          <secondary>Hooks</secondary>
        </indexterm><indexterm>
          <primary>Hooks</primary>
        </indexterm></title>

      <para>Vereinfacht gesagt, sind Hooks eine Möglichkeit, die Ausgabe eines
      Moduls zu verändern. Einige Hooks (sogenannte
      <emphasis>Transform-Hooks</emphasis><indexterm>
          <primary>Transform-Hooks</primary>

          <see>Hooks</see>
        </indexterm><indexterm>
          <primary>Hooks</primary>

          <secondary>Transform-Hooks</secondary>
        </indexterm>) verändern die Ausgabe, so wandet der "Autolinks"-Hook
      bestimmte Begriffe in Links um, der bbcode-Hook wandelt textuelle in
      grafische Smilies. Andere Hooks (sogenannte
      <emphasis>Display-Hooks<indexterm>
          <primary>Display-Hooks</primary>

          <see>Hooks</see>
        </indexterm></emphasis><indexterm>
          <primary>Hooks</primary>

          <secondary>Display-Hooks</secondary>
        </indexterm>) hängen etwas an die Ausgabe an: EZComments fügt an die
      Ausgabe ein Kommentarfeld an, Ratings eine Bewertungsfunktion
      usw.</para>

      <para>Damit ein solches Hook-Modul aktiv wird, muss es für ein anderes
      aktiviert werden. Dies geschieht unter <guimenuitem>Hooks</guimenuitem>
      in der Modul-Administration.</para>

      <para>Beispiel: Um <replaceable>Autolinks</replaceable> für die
      <replaceable>News</replaceable> zu aktivieren, sucht man
      <replaceable>News</replaceable> in der Modulverwaltung heraus und klickt
      auf <guimenuitem>Hooks</guimenuitem>. Dort klickt man
      <guimenuitem>aktiviere <replaceable>Autolinks</replaceable> für dieses
      Modul</guimenuitem> an. Fortan stehen die Autolinks in den News zur
      Verfügung.</para>

      <note>
        <para>Nicht alle Module unterstützen alle Arten von Hooks.</para>
      </note>
    </section>
  </section>

  <section id="Blockadministration">
    <title>Blockadministration<indexterm>
        <primary>Blöcke</primary>

        <secondary>Administration</secondary>
      </indexterm><indexterm>
        <primary>Blöcke</primary>

        <secondary>Verwaltung</secondary>
      </indexterm></title>

    <para>Über den Punkt <guimenuitem>Blöcke</guimenuitem> in der
    Administration werden die Blöcke verwaltet. Zunächst werden die bereits
    bestehenden Blöcke aufgelistet. Zu jedem Block ist angegeben, an welcher
    Stelle er erscheint (d.h. sowohl die 'Rangfolge' als auch in welcher
    'Leiste'), wie er heißt, von welchem Modul er bereitgestellt wird, und ob
    er aktiv ist.</para>

    <screenshot>
      <mediaobject>
        <imageobject>
          <imagedata align="center" fileref="bloecke.gif" format="GIF" />
        </imageobject>

        <textobject>
          <phrase>Die Blockadministration</phrase>
        </textobject>
      </mediaobject>
    </screenshot>

    <para>Für jeden Block stehen folgende Funktionen zur Verfügung:</para>

    <variablelist>
      <varlistentry>
        <term>Deaktivieren</term>

        <listitem>
          <para>Der Block wird nicht mehr angezeigt, bleibt aber im
          System</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Editieren</term>

        <listitem>
          <para>Ändern der Einstellungen eines Blocks. Diese Einstellungen
          sind je nach Blockart verschieden.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Löschen</term>

        <listitem>
          <para>Löscht den Block komplett aus dem System.</para>
        </listitem>
      </varlistentry>
    </variablelist>

    <para>Mit den Pfeilen könne die Blöcke in der Reihenfolge verschoben
    werden. Mit einem Klick auf den gewünschten Pfeil wandert der Block um
    eine Position rauf oder runter. Die Position (links, mitte, rechts) kann
    man beeinflussen, wenn man auf Editieren klickt. Für jeden Block gibt es
    die folgenden Felder:</para>

    <variablelist>
      <varlistentry>
        <term>Titel</term>

        <listitem>
          <para>Der Titel des Blocks. Dieser wird üblicherweise auch im Block
          selbst angezeigt</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Position</term>

        <listitem>
          <para>Links, Rechts, Mitte</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Sprache</term>

        <listitem>
          <para>Die Sprache des Portals, für das der Block angezeigt werden
          soll.</para>
        </listitem>
      </varlistentry>
    </variablelist>

    <para>Weitere Möglichkeiten der Blockverwaltung</para>

    <variablelist>
      <varlistentry>
        <term>Neuer Block</term>

        <listitem>
          <para>Hier wird ein neuer Block angelegt. Die Funktion des Blocks
          wird über ein Pulldownmenü festgelegt. Nach dem Klick auf
          'Erstellen' wird der Block angelegt. Natürlich läßt er sich später
          auch noch ändern, indem man in der Übersicht auf 'Editieren'
          klickt</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Blöcke Anzeigen</term>

        <listitem>
          <para>Zeigt eine Übersicht der Blöcke an.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Aktive Blöcke</term>

        <term>Alle Blöcke</term>

        <listitem>
          <para>Wechselt zwischen den Ansichten aller Blöcke oder nur der
          aktiven Blöcke.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Konfigurieren</term>

        <listitem>
          <para>Schaltet die Colapse-Funktion der Blöcke an bzw. aus. Diese
          Funktion ermöglicht einem registrierten Benutzer, die Inhalte eines
          Blocks 'wegzuklappen'. Seit Postuke .714 kann man die
          "minimize/maximize"-Knöpfe im Administrationsbereich - Blöcke -
          konfigurieren mit der Option "Symbole zur Block-Verkleinerung
          aktivieren?" ein- bzw. ausschalten. Die entsprechenden Icons sind
          übrigens in <filename>/images/global/downb.gif</filename> bzw.
          <filename>upb.gif</filename> zu finden.</para>
        </listitem>
      </varlistentry>
    </variablelist>

    <bridgehead>Wie kann ich bei meinem Modul dafür sorgen, daß die rechten
    Blöcke angezeigt werden?</bridgehead>

    <para>Bei den Modulen kann man durch Setzen von <command>$index =
    1;</command> festlegen, ob die rechten Blöcke angezeigt werden sollen oder
    nicht.</para>
  </section>
</chapter>